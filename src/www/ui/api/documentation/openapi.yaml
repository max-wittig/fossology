
swagger: '2.0'
info:
  title: FOSSology API
  description: Automate your fossology instance using this API
  version: "1.0.0"
# the domain of the service
host: localhost
# array of all schemes that your API supports
schemes:
  - https
# will be prefixed to all paths
basePath: /repo/api/v1
securityDefinitions:
  UserSecurity:
    type: apiKey
    in: header
    name: SIMPLE-API-KEY
security:
  - UserSecurity: []

produces:
  - application/json
paths:
  /organize/uploads/{id}:
    get:
      tags:
        - Upload
        - Organize
      summary: Get single upload by id
      description:
        Returns an array with single upload
      parameters:
        - name: id
          required: true
          description: Id of the upload
          in: path
          type: number
          format: int
      responses:
        200:
          description: Get upload
          schema:
            type: array
            items:
              $ref: '#/definitions/Upload'
        400:
          description: Bad request, id NaN etc.
          schema:
            $ref: '#/definitions/Info'
        401:
          description: Unauthorized, no authentification provided
          schema:
            $ref: '#/definitions/Info'
        403:
          description: Forbidden, no access to upload
          schema:
            $ref: '#/definitions/Info'
        404:
          description: Not found
          schema:
            $ref: '#/definitions/Info'
    delete:
      tags:
        - Upload
        - Organize
      summary: Delete upload by id
      parameters:
        - name: id
          required: true
          in: path
          type: number
          format: int
      responses:
        202:
          description: Upload will be deleted
          schema:
            $ref: '#/definitions/Info'
        400:
          description: Bad request, id NaN etc.
          schema:
            $ref: '#/definitions/Info'
        401:
          description: Unauthorized, no authentification provided
          schema:
            $ref: '#/definitions/Info'
        403:
          description: Forbidden, no access to upload
          schema:
            $ref: '#/definitions/Info'
        404:
          description: Not found
          schema:
            $ref: '#/definitions/Info'
    patch:
      tags:
        - Upload
        - Organize
      parameters:
        - name: id
          description: uploadid
          in: path
          required: true
          type: number
        - name: folder_id
          description: folder, where upload is located (change this to move upload)
          in: header
          required: false
          type: string
      responses:
        202:
          description: Upload will be moved
          schema:
            $ref: '#/definitions/Info'
        400:
          description: Bad request, id NaN etc.
          schema:
            $ref: '#/definitions/Info'
        401:
          description: Unauthorized, no authentification provided
          schema:
            $ref: '#/definitions/Info'
        403:
          description: Forbidden, no access to upload
          schema:
            $ref: '#/definitions/Info'
        404:
          description: Not found
          schema:
            $ref: '#/definitions/Info'
    put:
      tags:
        - Upload
        - Organize
      description: Can be used to copy uploads
      parameters:
        - name: id
          description: uploadid
          in: path
          required: true
          type: number
        - name: folder_id
          description: Folder Id, where upload should be copied to
          in: header
          required: true
          type: number
      responses:
        202:
          description: Upload will be copied
          schema:
            $ref: '#/definitions/Info'
        400:
          description: Bad request
          schema:
            $ref: '#/definitions/Info'
        401:
          description: Unauthorized, no authentification provided
          schema:
            $ref: '#/definitions/Info'
        403:
          description: Forbidden, no access to upload
          schema:
            $ref: '#/definitions/Info'
        404:
          description: Id not found
          schema:
            $ref: '#/definitions/Info'

  /organize/uploads:
    get:
      tags:
        - Upload
      summary: Uploads
      description: |
        The uploads endpoint returns all uploads
      responses:
        200:
          description: An array of uploads
          schema:
            type: array
            items:
              $ref: '#/definitions/Upload'
        401:
          description: Unauthorized, no authentification provided
          schema:
            $ref: '#/definitions/Info'
        403:
          description: Forbidden, no access to upload
          schema:
            $ref: '#/definitions/Info'
        default:
          description: Unexpected error
          schema:
            $ref: '#/definitions/Info'
  /search:
      get:
        tags:
          - Search
        parameters:
          - name: searchType
            # use 'allfiles', if not given
            required: false
            description: Limit search to
            in: header
            type: string
            enum:
              - directory
              - containers
              - allfiles
          - name: filename
            description: Filename to find, can contain % as wild-card
            required: false
            in: header
            type: string
          - name: tag
            description: Tag to find
            required: false
            in: header
            type: string
          - name: filesizemin
            description: Min filesize in bytes
            required: false
            in: header
            type: number
          - name: filesizemax
            description: Max filesize in bytes
            required: false
            in: header
            type: number
          - name: license
            description: License search filter
            required: false
            in: header
            type: string
          - name: copyright
            description: Copyright search filter
            required: false
            in: header
            type: string
        responses:
          200:
            description: OK
            schema:
              type: array
              items:
                $ref: '#/definitions/Upload'
          400:
            description: Bad request, at least 1 parameter must be provider for search
            schema:
              $ref: '#/definitions/Error'
          401:
            description: Unauthorized, no authentification provided
            schema:
              $ref: '#/definitions/Error'
definitions:
  Upload:
    type: object
    properties:
      folder_id:
        type: number
        format: int
        description: The folder id, where the upload is located
      id:
        type: number
        format: int
        description: Upload id of the upload.
      description:
        type: string
        description: Description of the upload.
      upload_name:
        type: string
        description: Display name of the upload.
      upload_date:
        type: string
        description: Date, when the file was uploaded.
      file_size:
        type: number
        description: Filesize in Bytes.
  Info:
    type: object
    properties:
      code:
        type: integer
        format: int32
      message:
        type: string
      type:
        type: string

